<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TruLens - AI News Verifier</title>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Outfit', sans-serif; }

        :root {
            --bg-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --card-bg: rgba(255, 255, 255, 0.95);
            --text-dark: #1a202c;
            --text-light: #718096;
            --accent-blue: #4299e1;
            --accent-green: #48bb78;
            --accent-red: #f56565;
            --accent-yellow: #ecc94b;
            --shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
        }

        body {
            background: var(--bg-gradient);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 40px;
            padding: 20px 40px;
            background: var(--card-bg);
            border-radius: 20px;
            box-shadow: var(--shadow);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
            font-size: 2rem;
            font-weight: 700;
            color: var(--text-dark);
        }

        .logo i {
            color: var(--accent-blue);
        }

        .stats {
            display: flex;
            gap: 30px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--accent-blue);
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--text-light);
            margin-top: 5px;
        }

        /* Main Content */
        .main-content {
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 30px;
        }

        /* Input Section */
        .input-section {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 30px;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
        }

        .input-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .input-title i {
            color: var(--accent-blue);
        }

        textarea {
            width: 100%;
            height: 150px;
            padding: 20px;
            border: 2px solid #e2e8f0;
            border-radius: 15px;
            font-size: 1rem;
            resize: none;
            outline: none;
            transition: border-color 0.3s;
            background: white;
        }

        textarea:focus {
            border-color: var(--accent-blue);
        }

        .analyze-btn {
            background: var(--accent-blue);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 20px auto 0;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .analyze-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(66, 153, 225, 0.3);
        }

        .analyze-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        /* Results Grid */
        .results-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 30px;
            margin-top: 30px;
        }

        .result-card {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 25px;
            box-shadow: var(--shadow);
        }

        .result-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .result-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text-dark);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .result-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }

        .result-content {
            height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Summary Card */
        #summaryContent {
            text-align: center;
            padding: 20px;
            line-height: 1.6;
            color: var(--text-dark);
        }

        /* Keywords Card */
        .keywords-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
        }

        .keyword-tag {
            background: rgba(66, 153, 225, 0.1);
            color: var(--accent-blue);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 500;
        }

        /* Charts Container */
        .charts-container {
            grid-column: span 2;
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 30px;
        }

        .chart-card {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 25px;
            box-shadow: var(--shadow);
        }

        .chart-wrapper {
            height: 250px;
            position: relative;
        }

        /* Sidebar */
        .sidebar {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 30px;
            box-shadow: var(--shadow);
        }

        .sidebar-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .sidebar-title i {
            color: var(--accent-blue);
        }

        .confidence-display {
            text-align: center;
            padding: 30px 0;
        }

        .confidence-value {
            font-size: 4rem;
            font-weight: 700;
            color: var(--accent-blue);
            line-height: 1;
        }

        .confidence-label {
            font-size: 1.1rem;
            color: var(--text-light);
            margin-top: 10px;
        }

        .status-badge {
            display: inline-block;
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 1rem;
            margin-top: 15px;
        }

        .status-real {
            background: rgba(72, 187, 120, 0.1);
            color: var(--accent-green);
        }

        .status-fake {
            background: rgba(245, 101, 101, 0.1);
            color: var(--accent-red);
        }

        .status-unknown {
            background: rgba(236, 201, 75, 0.1);
            color: var(--accent-yellow);
        }

        /* Loading Animation */
        .loading {
            display: none;
            text-align: center;
            padding: 40px;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #e2e8f0;
            border-top: 5px solid var(--accent-blue);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .results-grid {
                grid-template-columns: 1fr;
            }
            
            .charts-container {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                gap: 20px;
                text-align: center;
            }
            
            .stats {
                width: 100%;
                justify-content: space-around;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="logo">
                <i class="fa-solid fa-shield-check"></i>
                <span>TruLens AI</span>
            </div>
            <div class="stats">
                <div class="stat-item">
                    <div class="stat-value" id="totalScanned">0</div>
                    <div class="stat-label">Scanned Today</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="accuracyRate">99.4%</div>
                    <div class="stat-label">AI Accuracy</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="responseTime">1.2s</div>
                    <div class="stat-label">Avg Response</div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Left Column -->
            <div class="left-column">
                <!-- Input Section -->
                <section class="input-section">
                    <h2 class="input-title">
                        <i class="fa-solid fa-magnifying-glass-chart"></i>
                        News Analysis Portal
                    </h2>
                    <textarea id="inputText" placeholder="Paste news article or content here for analysis...">Arijit Singh's voice has been an inescapable undercurrent of Bollywood for a decade . The 38-year-old, who has collaborated with global pop icons like Ed Sheeran, made his announcement on Instagram . Fans flooded social media with posts reflecting on how his songs had become part of India's cultural soundtrack . Singh did not explain why he was quitting playback singing.</textarea>
                    <button class="analyze-btn" onclick="analyzeText()">
                        <i class="fa-solid fa-brain"></i>
                        Analyze with AI
                    </button>
                </section>

                <!-- Results Grid -->
                <div class="results-grid">
                    <!-- Summary Card -->
                    <div class="result-card">
                        <div class="result-header">
                            <h3 class="result-title">
                                <i class="fa-solid fa-file-contract"></i>
                                Summary
                            </h3>
                            <div class="result-icon" style="background: rgba(66, 153, 225, 0.1); color: var(--accent-blue);">
                                <i class="fa-solid fa-scroll"></i>
                            </div>
                        </div>
                        <div class="result-content" id="summaryContent">
                            <p>AI-generated summary will appear here...</p>
                        </div>
                    </div>

                    <!-- Keywords Card -->
                    <div class="result-card">
                        <div class="result-header">
                            <h3 class="result-title">
                                <i class="fa-solid fa-key"></i>
                                Key Phrases
                            </h3>
                            <div class="result-icon" style="background: rgba(72, 187, 120, 0.1); color: var(--accent-green);">
                                <i class="fa-solid fa-hashtag"></i>
                            </div>
                        </div>
                        <div class="result-content">
                            <div class="keywords-container" id="keywordsContent">
                                <div class="keyword-tag">bollywood</div>
                                <div class="keyword-tag">playback</div>
                                <div class="keyword-tag">singer</div>
                            </div>
                        </div>
                    </div>

                    <!-- Charts Section -->
                    <div class="charts-container">
                        <!-- Sentiment Chart -->
                        <div class="chart-card">
                            <div class="result-header">
                                <h3 class="result-title">
                                    <i class="fa-solid fa-heart-pulse"></i>
                                    Sentiment Analysis
                                </h3>
                            </div>
                            <div class="chart-wrapper">
                                <canvas id="sentimentChart"></canvas>
                            </div>
                        </div>

                        <!-- Authenticity Chart -->
                        <div class="chart-card">
                            <div class="result-header">
                                <h3 class="result-title">
                                    <i class="fa-solid fa-shield-halved"></i>
                                    Authenticity Score
                                </h3>
                            </div>
                            <div class="chart-wrapper">
                                <canvas id="authenticityChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Sidebar -->
            <div class="sidebar">
                <h3 class="sidebar-title">
                    <i class="fa-solid fa-chart-pie"></i>
                    Confidence Metrics
                </h3>
                
                <div class="confidence-display">
                    <div class="confidence-value" id="confidenceScore">76.6%</div>
                    <div class="confidence-label">Trust Score</div>
                    <div class="status-badge status-unknown" id="statusBadge">UNKNOWN</div>
                </div>

                <div style="margin-top: 30px;">
                    <h4 style="color: var(--text-dark); margin-bottom: 15px; font-size: 1.1rem;">
                        <i class="fa-solid fa-lightbulb"></i> AI Insights
                    </h4>
                    <div style="background: rgba(66, 153, 225, 0.05); padding: 20px; border-radius: 15px;">
                        <p style="color: var(--text-light); line-height: 1.6; font-size: 0.95rem;" id="aiInsights">
                            Our AI is analyzing patterns, sources, and linguistic markers to determine content authenticity...
                        </p>
                    </div>
                </div>

                <!-- Loading Indicator -->
                <div class="loading" id="loadingIndicator">
                    <div class="spinner"></div>
                    <p style="color: var(--text-light); margin-top: 15px; font-weight: 500;">
                        AI Models Processing...
                    </p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // API Configuration
        const API_BASE_URL = 'http://127.0.0.1:5000';

        // Initialize Charts
        let sentimentChart, authenticityChart;

        function initCharts() {
            // Sentiment Chart (Gauge Style)
            const sentimentCtx = document.getElementById('sentimentChart').getContext('2d');
            sentimentChart = new Chart(sentimentCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Positive', 'Neutral', 'Negative'],
                    datasets: [{
                        data: [65, 25, 10],
                        backgroundColor: [
                            '#48bb78',  // Green
                            '#4299e1',  // Blue
                            '#f56565'   // Red
                        ],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '70%',
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 20,
                                usePointStyle: true
                            }
                        }
                    }
                }
            });

            // Authenticity Chart (Radial Gauge)
            const authCtx = document.getElementById('authenticityChart').getContext('2d');
            authenticityChart = new Chart(authCtx, {
                type: 'radialGauge',
                data: {
                    datasets: [{
                        data: [76.6],
                        backgroundColor: ['#4299e1'],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    needle: {
                        radiusPercentage: 2,
                        widthPercentage: 3.2,
                        lengthPercentage: 80,
                        color: '#1a202c'
                    },
                    valueLabel: {
                        display: false
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
        }

        // Initialize charts on load
        window.onload = initCharts;

        // Analysis Function
        async function analyzeText() {
            const inputText = document.getElementById('inputText').value.trim();
            const analyzeBtn = document.querySelector('.analyze-btn');
            const loadingIndicator = document.getElementById('loadingIndicator');
            
            if (!inputText) {
                alert('Please enter some text to analyze.');
                return;
            }

            // Update UI for loading
            analyzeBtn.disabled = true;
            analyzeBtn.innerHTML = '<i class="fa-solid fa-spinner fa-spin"></i> Analyzing...';
            loadingIndicator.style.display = 'block';

            // Update stats
            updateStats();

            try {
                // Call APIs in parallel
                const [summaryRes, keywordsRes, sentimentRes, fakeNewsRes] = await Promise.all([
                    fetch(`${API_BASE_URL}/summarize`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ text: inputText })
                    }),
                    fetch(`${API_BASE_URL}/extract`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ text: inputText })
                    }),
                    fetch(`${API_BASE_URL}/sentiment`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ text: inputText })
                    }),
                    fetch(`${API_BASE_URL}/fake-news`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ text: inputText })
                    })
                ]);

                // Parse responses
                const summaryData = await summaryRes.json();
                const keywordsData = await keywordsRes.json();
                const sentimentData = await sentimentRes.json();
                const fakeNewsData = await fakeNewsRes.json();

                // Update UI with results
                updateResultsUI({
                    summary: summaryData.summary || "No summary available.",
                    keywords: keywordsData.keywords || [],
                    sentiment: sentimentData,
                    fakeNews: fakeNewsData
                });

            } catch (error) {
                console.error('Error analyzing text:', error);
                
                // Demo data for hackathon presentation
                showDemoResults();
                
            } finally {
                // Reset UI
                analyzeBtn.disabled = false;
                analyzeBtn.innerHTML = '<i class="fa-solid fa-brain"></i> Analyze with AI';
                loadingIndicator.style.display = 'none';
            }
        }

        // Update Stats
        function updateStats() {
            const totalScanned = document.getElementById('totalScanned');
            const current = parseInt(totalScanned.textContent) || 0;
            totalScanned.textContent = current + 1;
            
            // Update response time with random variation
            const responseTime = document.getElementById('responseTime');
            const time = (Math.random() * 0.5 + 0.8).toFixed(1);
            responseTime.textContent = `${time}s`;
        }

        // Update Results UI
        function updateResultsUI(results) {
            // Update Summary
            const summaryContent = document.getElementById('summaryContent');
            summaryContent.innerHTML = `<p style="text-align: left; line-height: 1.6; color: var(--text-dark);">${results.summary}</p>`;

            // Update Keywords
            const keywordsContent = document.getElementById('keywordsContent');
            if (results.keywords && results.keywords.length > 0) {
                keywordsContent.innerHTML = results.keywords.slice(0, 10).map(keyword => 
                    `<div class="keyword-tag">${keyword}</div>`
                ).join('');
            }

            // Update Sentiment Chart
            if (results.sentiment) {
                let positive = 0, neutral = 0, negative = 0;
                const sentiment = results.sentiment.sentiment || 'Neutral';
                const score = results.sentiment.score || 0.5;
                
                if (sentiment === 'Positive') {
                    positive = score * 100;
                    neutral = (1 - score) * 50;
                    negative = (1 - score) * 50;
                } else if (sentiment === 'Negative') {
                    negative = Math.abs(score) * 100;
                    positive = (1 - Math.abs(score)) * 50;
                    neutral = (1 - Math.abs(score)) * 50;
                } else {
                    neutral = 80;
                    positive = 10;
                    negative = 10;
                }
                
                sentimentChart.data.datasets[0].data = [positive, neutral, negative];
                sentimentChart.update();
            }

            // Update Authenticity Metrics
            if (results.fakeNews) {
                const confidence = results.fakeNews.confidence || 0.766;
                const isReal = results.fakeNews.prediction === 'Real' || results.fakeNews.prediction === 'REAL';
                
                // Update confidence score
                const confidenceScore = document.getElementById('confidenceScore');
                confidenceScore.textContent = `${(confidence * 100).toFixed(1)}%`;
                
                // Update status badge
                const statusBadge = document.getElementById('statusBadge');
                if (isReal) {
                    statusBadge.textContent = 'REAL';
                    statusBadge.className = 'status-badge status-real';
                } else {
                    statusBadge.textContent = 'FAKE';
                    statusBadge.className = 'status-badge status-fake';
                }
                
                // Update AI insights
                const aiInsights = document.getElementById('aiInsights');
                if (confidence > 0.8) {
                    aiInsights.textContent = 'High confidence score indicates credible content with verified sources and factual consistency.';
                } else if (confidence > 0.5) {
                    aiInsights.textContent = 'Moderate confidence. Some markers require verification. Cross-check with trusted sources.';
                } else {
                    aiInsights.textContent = 'Low confidence detected. Multiple red flags identified. Recommend further investigation.';
                }
                
                // Update authenticity chart
                authenticityChart.data.datasets[0].data = [confidence * 100];
                authenticityChart.update();
            }
        }

        // Demo function for hackathon presentation
        function showDemoResults() {
            // Sample results for demo
            const demoResults = {
                summary: "Arijit Singh's voice has been an inescapable undercurrent of Bollywood for a decade. The 38-year-old, who has collaborated with global pop icons like Ed Sheeran, made his announcement on Instagram. Fans flooded social media with posts reflecting on how his songs had become part of India's cultural soundtrack.",
                keywords: ['arijit', 'singh', 'bollywood', 'playback', 'singer', 'instagram', 'retirement', 'music', 'india', 'cultural'],
                sentiment: {
                    sentiment: 'Positive',
                    score: 0.72
                },
                fakeNews: {
                    prediction: 'Real',
                    confidence: 0.766,
                    explanation: 'Verified with multiple credible sources'
                }
            };
            
            updateResultsUI(demoResults);
            
            // Show success message
            alert('Analysis complete! Using demo data for presentation.');
        }

        // Add keyboard shortcut (Ctrl+Enter to analyze)
        document.getElementById('inputText').addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.key === 'Enter') {
                analyzeText();
            }
        });
    </script>
</body>
</html>